<div class="row chatroom-container" data-current-user-id="<%= current_user.id %>" id = "main-container" >
  <div class="col-12 col-md-4 chats" data-controller="chatrooms">
    <div class=" chatroom", id = "chatrooms">
    <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
      <% @chatrooms.each do |chatroom| %>
        <span class = "chatroom<%= chatroom.id %> chatroom" data-id="<%= chatroom.id %>" data-target="chatrooms.chatroom" data-action="click->chatrooms#toto">
          <div class="elements-chatroom row">
            <div class="col-4">
              <h3><%= chatroom.platform_account.user.first_name %></h3>
              <% platform = Platform.find(chatroom.platform_account.platform_id) %>
              <%= cl_image_tag platform.logo.key, width: 100, crop: :fill if platform.logo.attached? %>
            </div>
            <div class="photos row col-8 align-items-center">
              <% chatroom.users.each do |user|  %>
                <div class="col-3">
                  <% if user.photo.attached? %>
                    <%= cl_image_tag user.photo.key,class: "user-avatar", crop: :fill %>
                  <% else %>
                    <img class = "user-avatar" src="https://i0.wp.com/ahfirstaid.org/wp-content/uploads/2014/07/avatar-placeholder.png" alt="">
                  <% end %>
              </div>
              <% end %>
            </div>
          </div>
        </span> <br>
        <% end %>
    </div>
  </div>
  </div>
  <div class="col-12 col-md-8 px-0">
    <% @chatrooms.each do |chatroom| %>
      <div id="messages-<%= chatroom.id%>" data-chatroom-id="<%= chatroom.id %>" class = "d-none messages">
        <% chatroom.messages.each do |message| %>
          <%= render 'chatrooms/message', message: message %>
        <% end %>
      </div>
    <% end %>
    <div class="d-none user-id"><%= current_user.id %></div>
    <div class = "d-none chatroom-selected"></div>
    <div class="d-none" data-user-id="<%= current_user.id %>"></div>

    <% message = Message.new %>
    <% @chatrooms.each do |chatroom| %>
    <div class="d-none form-chatroom form-<%= chatroom.id %>">
      <%= simple_form_for [ chatroom, message ], remote: true do |f| %>
      <div  class = "row justify-content-center">
        <div class="col-8">
          <%= f.input :content, label: false, input_html: { class: " content-#{chatroom.id}" }, placeholder: "Message" %>
        </div>
        <div class="col-4">
          <%= f.submit 'ğŸ“®', class: " submit-btn-chat"%>
        </div>
      </div>
      <% end %>
    </div>
    <% end %>
</div>
<%# reste Ã  faire sur les chatrooms: -control du scroll (trÃ¨s rapide) ok pour la non crÃ©ation
                                     -Ajax (presque fait)
                                     -Front (amÃ©liorer les show des messages + chatrooms)
                                     -Checker que tout fonctionne bien Surtout le Action cable %>
